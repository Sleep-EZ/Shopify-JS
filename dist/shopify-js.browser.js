window.ShopifyJS=function(t){function e(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var r={};return e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=4)}([function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SHOPIFY_TYPE_PRODUCT="product",e.SHOPIFY_TYPE_COLLECTION="collection",e.SHOPIFY_TYPE_PAGE="page",e.SHOPIFY_TYPE_VARIANT="variant",e.VALID_SHOPIFY_TYPES=[e.SHOPIFY_TYPE_PRODUCT,e.SHOPIFY_TYPE_PAGE,e.SHOPIFY_TYPE_COLLECTION]},function(t,e,r){"use strict";var n=this&&this.__assign||Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t};Object.defineProperty(e,"__esModule",{value:!0});var o=r(2),c=r(0),i=r(0);e.CACHE_TS_KEY="__ts",e.CACHE_DEFAULT_CACHE_EXPIRY=300,e.CACHE_DEFAULT_DATA=(s={},s[i.SHOPIFY_TYPE_PRODUCT]={},s[i.SHOPIFY_TYPE_PAGE]={},s[i.SHOPIFY_TYPE_COLLECTION]={},s[c.SHOPIFY_TYPE_VARIANT]={},s),e.CACHE_DEFAULT_OPTS={cacheTimeout:e.CACHE_DEFAULT_CACHE_EXPIRY};var u=function(){function t(t,r){var o=e.CACHE_DEFAULT_OPTS;this.options=n({},o,t),this._cache=r||e.CACHE_DEFAULT_DATA}return t.prototype.readCache=function(){return n({},this._cache)},t.prototype.writeCache=function(t){this._cache=n({},t)},t.prototype._fetch_entry=function(t,r){var n=null,c=this.options.cacheTimeout||e.CACHE_DEFAULT_CACHE_EXPIRY;if(t===i.SHOPIFY_TYPE_PRODUCT?n=this._cache.product:t===i.SHOPIFY_TYPE_PAGE?n=this._cache.page:t===i.SHOPIFY_TYPE_COLLECTION&&(n=this._cache.collection),n&&r in n){var u=n[r],s=u[e.CACHE_TS_KEY];return function(t){return(o.getCurrentEpoch()-t)/1e3>c}(s)?(delete n[r],null):u}return null},t.prototype.fetch=function(t,e){switch(this._fetch_entry(t,e),t){case i.SHOPIFY_TYPE_PRODUCT:return this._fetch_product(e);case i.SHOPIFY_TYPE_PAGE:return this._fetch_page(e);case i.SHOPIFY_TYPE_COLLECTION:return this._fetch_collection(e);default:return null}},t.prototype._fetch_product=function(t){return this._cache.product[t]},t.prototype._fetch_page=function(t){return this._cache.page[t]},t.prototype._fetch_collection=function(t){return this._cache.collection[t]},t.prototype.set=function(t,r,c){var u=null;switch(t){case i.SHOPIFY_TYPE_PRODUCT:u=this._cache.product;break;case i.SHOPIFY_TYPE_PAGE:u=this._cache.page;break;case i.SHOPIFY_TYPE_COLLECTION:u=this._cache.collection}u&&(u[r]=n({},c,(s={},s[e.CACHE_TS_KEY]=o.getCurrentEpoch(),s)));var s},t}();e.default=u;var s},function(t,e,r){"use strict";function n(){return+new Date}function o(t){return t+"s"}Object.defineProperty(e,"__esModule",{value:!0}),e.getCurrentEpoch=n,e.pluralizeType=o},function(t,e,r){"use strict";function n(t,e){function r(t,e){var r={};return Object.keys(t).forEach(function(n){var o=t[n];if(o){var c=o.__ts,i=e.cacheTimeout;(Date.now()-c)/1e3<=i&&(r[n]=o)}}),r}var n=i.CACHE_DEFAULT_DATA;return t?Object.assign({},t,{product:r(t.product,e),collection:r(t.collection,e),page:r(t.page,e)}):n}var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var c=r(7),i=r(1),u=function(){function t(t){this.opts=t||i.CACHE_DEFAULT_OPTS}return t.prototype.read=function(){return Promise.resolve(i.CACHE_DEFAULT_DATA)},t.prototype.write=function(t){return Promise.resolve(!0)},t.DEFAULT_CACHE_KEY_NAME="shopify_js_cache",t}();e.StorageDriver=u;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.read=function(){var t=this,e=u.DEFAULT_CACHE_KEY_NAME;return console.log("READ"),c.getItem(e).then(function(e){return e?n(e,t.opts):void 0}).catch(function(t){return console.error(t)})},e.prototype.write=function(t){var e=u.DEFAULT_CACHE_KEY_NAME;return console.log("WRITE",t),c.setItem(e,t).then(function(t){return!0})},e}(u);e.ForageStorageDriver=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(5),o=r.n(n),c=r(1),i=r.n(c),u=r(3),s=(r.n(u),r(0)),a=(r.n(s),r(2));r.n(a);r.d(e,"Client",function(){return o.a}),r.d(e,"Cache",function(){return i.a}),r.d(e,"Storage",function(){return u}),r.d(e,"Types",function(){return s}),r.d(e,"Lib",function(){return a})},function(t,e,r){"use strict";function n(t){return console&&console.log&&(console.log("Failed to read Shopify response\n"),console.log(t)),null}var o=this&&this.__assign||Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t};Object.defineProperty(e,"__esModule",{value:!0});var c=r(6).default,i=r(1),u=r(2),s=r(0),a=r(0),_=r(3),f=function(){function t(t){if(console.log(!t,Object.keys(t).indexOf("domain"),!t.domain.length||!/[\w\d\-\.]+/.test(t.domain)),!t||-1===Object.keys(t).indexOf("domain")||!t.domain.length||!/[\w\d\-\.]+/.test(t.domain))throw new Error('You must provide the Shopify store\'s domain name\n\texample: "my-store.myshopify.com"');var e=t.domain,r=t.cacheTimeout,n=void 0===r?i.CACHE_DEFAULT_CACHE_EXPIRY:r,o={cacheTimeout:n},c=t.storage,u=void 0===c?new _.StorageDriver(o):c,s=t.cache,a=void 0===s?new i.default(o):s;this.cache=a,this.urlPrefix="https://"+e,this.storage=u||new _.StorageDriver}return t.prototype.read=function(){var t=this;return this.storage.read().then(function(e){return e?(t.cache._cache=e,e):null})},t.prototype.write=function(){return this.storage.write(this.cache._cache)},t.prototype._resolve_path=function(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return"/"+[u.pluralizeType(t),e].concat(r).join("/")+".json"},t.prototype.getProducts=function(t){var e=this;return Promise.all(t.map(function(t){return e.getProduct(t)}))},t.prototype.getProduct=function(t){return this.get(a.SHOPIFY_TYPE_PRODUCT,t)},t.prototype.getCollections=function(t){var e=this;return Promise.all(t.map(function(t){return e.getCollection(t)}))},t.prototype.getCollection=function(t){return this.get(a.SHOPIFY_TYPE_COLLECTION,t)},t.prototype.getCollectionProducts=function(t){var e=this.urlPrefix+this._resolve_path(a.SHOPIFY_TYPE_COLLECTION,t,"products");return c(e).then(function(t){return t.json()}).then(function(t){return t.products}).catch(n)},t.prototype.getPages=function(t){var e=this;return Promise.all(t.map(function(t){return e.getPage(t)}))},t.prototype.getPage=function(t){return this.get(a.SHOPIFY_TYPE_PAGE,t)},t.prototype.get=function(t,e){var r=this;if(-1===s.VALID_SHOPIFY_TYPES.indexOf(t))throw new Error("Refusing to get unknown Shopify type '"+t+"'");var o=this.cache.fetch(t,e);return o?Promise.resolve(o):c(this.urlPrefix+this._resolve_path(t,e)).then(function(t){return t.json()}).then(function(n){return r._processResponse.call(r,t,e,n)}).catch(n)},t.prototype._processResponse=function(t,e,r){function n(r,n){var i=o({},c,{products:r});return r.forEach(function(t){n.cache.set(a.SHOPIFY_TYPE_PRODUCT,t.handle,t)}),n.cache.set(t,e,i),n.storage.write(n.cache._cache),i}var c,i=this;switch(t){case a.SHOPIFY_TYPE_PRODUCT:c=r.product;break;case a.SHOPIFY_TYPE_PAGE:c=r.page;break;case a.SHOPIFY_TYPE_COLLECTION:c=r.collection;break;default:c=null}if(!c)throw new Error("Unable to process Shopify response\n"+c);return this.cache.set(t,e,c),this.storage.write(this.cache._cache),this.getCollectionProducts(e).then(function(t){return n(t,i)})},t}();e.default=f},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n="function"==typeof fetch?fetch.bind():function(t,e){return e=e||{},new Promise(function(r,n){function o(){var t,e=[],r=[],n={};return c.getAllResponseHeaders().replace(/^(.*?):\s*([\s\S]*?)$/gm,function(o,c,i){e.push(c=c.toLowerCase()),r.push([c,i]),t=n[c],n[c]=t?t+","+i:i}),{ok:1==(c.status/200|0),status:c.status,statusText:c.statusText,url:c.responseURL,clone:o,text:function(){return Promise.resolve(c.responseText)},json:function(){return Promise.resolve(c.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([c.response]))},headers:{keys:function(){return e},entries:function(){return r},get:function(t){return n[t.toLowerCase()]},has:function(t){return t.toLowerCase()in n}}}}var c=new XMLHttpRequest;c.open(e.method||"get",t);for(var i in e.headers)c.setRequestHeader(i,e.headers[i]);c.withCredentials="include"==e.credentials,c.onload=function(){r(o())},c.onerror=n,c.send(e.body)})};e.default=n},function(t,e){!function(){t.exports=window.localforage}()}]);
//# sourceMappingURL=shopify-js.browser.js.map